<div *ngIf="!loading" class="spinner"></div>
<div class="row content ">
	<div class="col-3  p-2">
		<div class="row inputs">
			<div class="col">
				<div class="d-flex justify-content-around mb-3">

					<label class="primary p-2 rounded" for="saisir_text">
						<input type="radio" checked style="margin-right: 5px;" name="optradio" id="saisir_text"
							mat-raised-button (click)="onSelectTextArea($event)">Saisir un texte</label>


					<label class="primary p-2 rounded" for="upload_file">
						<input type="radio" style="margin-right: 5px;" name="optradio" id="upload_file"
							(click)="onSelectUploadFile($event)">Charger un fichier</label>

				</div>

				<div class="textArea" *ngIf="textArea">
					<div>
						<textarea placeholder="Saisir un texte (10000 caractères maximum) ..." rows="5"
							[(ngModel)]="text" maxlength="8000" class="rounded "></textarea>
					</div>

					<div class="d-flex justify-content-around align-items-center">
						<button *ngIf="textArea" (click)="sendToSpacy($event)" mat-raised-button
							class="primary">Cartographier</button>
						<button *ngIf="textArea" (click)="clearText()" mat-raised-button class="danger">Effacer</button>
						<!--<input type="file" accept=".txt,.zip" (change)="fileUpload($event)" #myInput>-->
					</div>

				</div>
				<div *ngIf="uploadFile" style="cursor: pointer;">
					<label for="fileDropReff" class="dropzone mat-elevation-z8 info" style="cursor: pointer;">
						<img src="assets/icons/upload.png" width="100" alt="" class="mb-1">

						<input type="file" accept=".txt,.zip" (change)="sendToSpacy($event)" #myInput class="mt-5"
							id="fileDropReff">

						<h5>Cliquez pour téléverser un fichier </h5>
						<h5>(type txt ou zip, taille maximale: 100 ko) </h5>
						<h4 class="warning px-2 rounded">{{fileName}}</h4>
					</label>
				</div>

				<h4 class="text-center danger rounded my-1 msg">{{msg}}</h4>
			</div>
		</div>
		<div class="row lieuList">
			<div *ngIf="foundCities.length === 0 && fileName !=''" class="spinner"></div>
			<div class="col-7 py-3" *ngIf="duplicatedCities.length > 0">

				<h3 class="text-center white mb-2 mat-elevation-z8 rounded py-2"
					style="display: block; margin:auto;  width:100%">Lieux dupliqués</h3>
				<div [ngClass]="{'rounded height2' :textArea, 'rounded height1' :!textArea}">
					<Div *ngFor="let location of duplicatedCities; let i=index">
						<label for="checkbox{{i}}" class="warning p-2 my-3 rounded mat-elevation-z8"
							style="display: block; margin:auto;  width:100%; margin-bottom:5px">
							<input type="checkbox" id="checkbox{{i}}"
								(click)="confirmLocation($event,location.id)"><span class="ml-1">{{location.city}}
								{{location.country}}</span>
						</label>
					</Div>
				</div>
				<button class="primary" mat-raised-button style="display: block; margin:auto;  width:100%"
					(click)="displayOnMap()">Afficher sur la carte</button>
			</div>
			<div class="col-5 py-3" *ngIf="notFoundCities.length > 0">
				<h3 class="text-center white mb-2 mat-elevation-z8 rounded py-2"
					style="display: block; margin:auto;  width:100%">non reconnus</h3>
				<div [ngClass]="{'rounded height2' :textArea, 'rounded height1' :!textArea}">
					<Div *ngFor="let location of notFoundCities;" class="my-3">
						<span class="danger p-2 my-3 rounded mat-elevation-z8 w-100 d-block">{{location.city}}</span>
					</Div>
				</div>

			</div>
		</div>
	</div>

	<div class="col-9">
		<div class="row" id="map">
			<button (click)="onSelectText(textSelected)" color="light" mat-mini-fab class="center-button"
				*ngIf="foundCities.length > 0 && onCenter">
				<mat-icon> my_location</mat-icon>
			</button>
			<button (click)="displayOnMap()" color="light" mat-mini-fab class="center-button"
				*ngIf="foundCities.length > 0  && !onCenter">
				<mat-icon> my_location</mat-icon>
			</button>

		</div>
		<div class="row slider d-flex items-align-center" *ngIf="foundCities.length > 0">
			<div class="col mt-3">
				<div *ngIf="listOfText.length > 0" class="row" style="width: 90%;">
					<input class="w-100" type="range" name="amountRange" min="0" max="{{listOfText.length}}" value="0"
						#ref (input)="onMoveSlider(ref.value)" />
				</div>
				<div *ngIf="listOfText.length > 0" class="row" style="width: 90%;">
					<button 
						mat-raised-button
						*ngFor="let text of listOfText" 
						(click)="onSelectText(text)" 
						class="light mx-1">
						{{text}}
					</button>

					<!-- <div class="col d-flex justify-content-end"
					style="border-right: 3px solid rgb(0, 0, 0);"
						*ngFor="let text of listOfText; let i=index" >
						<span>{{text}}</span>
					</div> -->
				</div>
			</div>
		</div>
	</div>
</div>






























<!-- <div [ngClass]="{'col-7' :foundCities.length > 0, 'col-9' :foundCities.length === 0}" id="map">
		<button (click)="displayOnMap()" color="light" mat-mini-fab class="center-button"
			*ngIf="foundCities.length > 0 ">
			<mat-icon> my_location</mat-icon>
		</button>
	</div> -->


<!--<mat-form-field class=" mt-3">
				<mat-label>Choose City (choice multiple)</mat-label>
				<mat-select (selectionChange)="confirmCity()" multiple [(ngModel)]="ids">
	
					<mat-option *ngFor="let location of foundCities" value="{{location.id}}">{{location.city}}
						{{location.country}}</mat-option>
				</mat-select>
			</mat-form-field>
	
			<mat-form-field appearance="fill">
				<mat-label>Séléctionner un pays</mat-label>
				<mat-select (selectionChange)="changeCountry()" [(ngModel)]="country">
					<mat-option *ngFor="let row of countries" value="{{row.country}}">{{row.country}}</mat-option>
				</mat-select>
			</mat-form-field>-->